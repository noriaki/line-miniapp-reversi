# ゲーム結果シェア機能 - 要求事項

## 概要

リバーシゲーム終了時に、結果盤面の画像を添えてシェアする機能を実装する。
LINEミニアプリの特性を活かし、LINEログイン済みであればShared Target Pickerによるシェア、ログイン状態にかかわらずスマートフォンの標準機能を利用したシェアを実現する。

## 機能要件

### F1: シェアトリガー

- ゲーム終了時にシェアボタンを表示
- 「新しいゲームを開始」ボタンの隣に配置
- 2つのシェアボタンを併記表示
  - 「LINEでシェア」ボタン
  - 「その他でシェア」ボタン

### F2: シェア方式

#### F2.1: LINEシェア（Shared Target Picker）

- **API**: LIFF SDK `liff.shareTargetPicker()`
- **コンテンツ形式**: Flex Message
- **Flex Message構成**:
  - シェア画像（盤面＋スコア＋勝敗＋ロゴ）
  - テキスト（結果＋招待文）
  - 「リバーシで遊ぶ」アプリ起動ボタン
- **ログイン状態による挙動**:
  - ログイン済み: 直接Shared Target Pickerを起動
  - 非ログイン時: タップでログインを実行し、完了後にシェアフローへ進む

#### F2.2: OS標準シェア（Web Share API）

- **API**: Web Share API (`navigator.share()`)
- **対応OS**: iOS / Android
- **条件**: ログイン状態にかかわらず常に利用可能
- **コンテンツ**: 画像ファイル＋テキスト

### F3: シェアコンテンツ

#### F3.1: 画像

- **含める情報**:
  - ゲーム終了時の盤面状態（8x8グリッド、黒白の石配置）
  - スコア表示（黒○個 vs 白○個）
  - 勝敗結果テキスト（「あなたの勝ち！」「AIの勝ち！」「引き分け」）
  - アプリロゴ/タイトル（ブランディング要素）
- **画像ホスティング**: 外部ストレージ（Cloudflare R2、Vercel Blobなど）にアップロードしURLを取得

#### F3.2: テキスト

- **形式**: 結果＋招待文＋アプリリンク
- **例**: 「リバーシで勝利！黒32 vs 白32 あなたも挑戦してみませんか？ [アプリURL]」

### F4: フィードバック

- シェア完了時: トースト通知で「シェアしました！」を一時表示
- シェア失敗時: トースト通知でエラーメッセージを表示
- シェアキャンセル時: 特に通知せず元の画面に戻る

## 非機能要件

### NF1: UX

- シェアボタンは視認性が高く、押しやすいサイズ
- シェア操作は直感的で迷わない
- LINEシェアボタンはLINEブランドカラー（緑）を使用

### NF2: 互換性

- LINEアプリ内ブラウザで動作
- 外部ブラウザ（Safari、Chrome）で動作
- iOS / Android両対応
- Web Share API非対応ブラウザでは「その他でシェア」ボタンを非表示

### NF3: パフォーマンス

- 画像生成はゲーム終了後速やかに実行
- 画像アップロードはユーザー体験を阻害しない

## スコープ外（将来検討）

- シェアテキストのカスタマイズ機能
- シェア履歴の保存
- シェア回数のトラッキング/分析
- 対人戦時の対戦相手情報表示

---

_このドキュメントはKiro SDD Requirements作成の入力として使用する_
