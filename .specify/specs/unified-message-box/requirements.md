# Requirements Document

## Introduction

本仕様は、リバーシミニアプリにおける統一メッセージボックス機能の要件を定義します。現在、パスの通知や打ち手の位置不正の警告などのメッセージが個別に表示されていますが、これらを単一のメッセージボックスコンポーネントに統合し、一貫性のあるユーザー体験を提供します。

統一メッセージボックスは、ページ上部に配置され、下部のゲーム盤面などのコンテンツに対してレイアウトシフト（Cumulative Layout Shift: CLS）を引き起こさない設計とします。モバイルファーストのタッチ操作環境において、メッセージの視認性とアクセシビリティを確保しつつ、ゲーム盤面を主役として維持する控えめな視覚デザインを採用します。

## Requirements

### Requirement 1: メッセージボックスの表示制御

**Objective:** ユーザーとして、ゲーム状態や操作に関する最新の通知を常に把握できるように、統一されたメッセージボックスで情報を受け取りたい

#### Acceptance Criteria

1. The メッセージボックスコンポーネント shall ページ上部の固定位置に表示される
2. When メッセージが発行された, the メッセージボックス shall 最新のメッセージのみを表示する
3. When 新しいメッセージが5秒以内に発行された, the メッセージボックス shall 現在表示中のメッセージを破棄し、新しいメッセージを優先表示する
4. The メッセージボックス shall メッセージ表示開始から5秒間経過後に自動的に非表示になる
5. When メッセージが存在しない, the メッセージボックス shall 非表示状態を維持する

### Requirement 2: レイアウト安定性の保証

**Objective:** ユーザーとして、メッセージ表示によってゲーム盤面の位置がずれることなく、快適にゲームをプレイしたい

#### Acceptance Criteria

1. The メッセージボックス shall 固定の高さを持ち、メッセージの有無によって高さが変動しない
2. When メッセージが表示・非表示になる, the メッセージボックス shall 下部のコンテンツ（ゲーム盤面など）のレイアウトシフト（CLS）を引き起こさない
3. The メッセージボックス shall 初期レンダリング時から固定領域を確保する
4. When フェードアニメーションが実行される, the メッセージボックス shall 不透明度のみを変化させ、レイアウト寸法を変更しない

### Requirement 3: メッセージタイプの視覚的区別

**Objective:** ユーザーとして、通常の通知と警告メッセージを視覚的に区別できるようにしたい。ただし、ゲーム盤面が主役であるため、派手な色使いは避けたい

#### Acceptance Criteria

1. The メッセージボックス shall 通常メッセージと警告メッセージの2種類のメッセージタイプをサポートする
2. When 通常メッセージが表示される, the メッセージボックス shall 通常メッセージ用の控えめな背景色とアイコンを使用する
3. When 警告メッセージが表示される, the メッセージボックス shall 警告メッセージ用の識別可能な背景色とアイコンを使用する
4. The メッセージボックス shall ゲーム盤面を主役として維持するため、派手な色（高彩度色、ネオンカラー等）を使用しない
5. The メッセージボックス shall モバイルデバイスの小さな画面でも視認可能なフォントサイズとコントラストを確保する

### Requirement 4: フェードアニメーション

**Objective:** ユーザーとして、メッセージの出現・消失が自然で滑らかなアニメーションで行われることで、快適なユーザー体験を得たい

#### Acceptance Criteria

1. When メッセージが表示される, the メッセージボックス shall 短い長さのフェードインアニメーションを実行する
2. When メッセージが非表示になる, the メッセージボックス shall 短い長さのフェードアウトアニメーションを実行する
3. The メッセージボックス shall フェードアニメーションの持続時間を0.3秒以下とする
4. The メッセージボックス shall フェードアニメーション中にレイアウトシフト（CLS）を引き起こさない
5. When フェードアニメーション中に新しいメッセージが発行された, the メッセージボックス shall 現在のアニメーションをキャンセルし、新しいメッセージのフェードインを開始する

### Requirement 5: メッセージ種別のサポート

**Objective:** ユーザーとして、ゲーム中に発生する様々な状況（パス、無効な操作など）に対する通知を統一されたインターフェースで受け取りたい

#### Acceptance Criteria

1. The メッセージボックス shall パス通知メッセージ（プレイヤーが有効な手を持たない場合の通知）を表示する
2. The メッセージボックス shall 無効な打ち手位置の警告メッセージ（ルールに違反する操作の警告）を表示する
3. The メッセージボックス shall ゲームロジックやUIコンポーネントから任意のテキストメッセージを受け入れる汎用インターフェースを提供する
4. The メッセージボックス shall 日本語テキストを適切にレンダリングする
5. The メッセージボックス shall メッセージテキストが長い場合でも、メッセージボックスの高さを超えないように表示する（省略記号やテキストの切り詰め）

### Requirement 6: 技術的実装要件

**Objective:** 開発者として、プロジェクトの技術スタックとアーキテクチャパターンに沿った保守可能なコードを実装したい

#### Acceptance Criteria

1. The メッセージボックスコンポーネント shall React 18のクライアントコンポーネントとして実装される
2. The メッセージボックス shall Tailwind CSSを主要なスタイリング手段として使用する
3. Where 複雑なアニメーション制御が必要な場合, the メッセージボックス shall プレーンCSSファイル（`MessageBox.css`等）を使用する
4. The メッセージボックス shall TypeScript strict modeで型安全性を確保する
5. The メッセージボックス shall カスタムフックを使用してメッセージ状態管理を`/hooks`ディレクトリに分離する
6. The メッセージボックス shall プレゼンテーショナルコンポーネントとして`/components`ディレクトリに配置される
7. The メッセージボックス shall Jest + React Testing Libraryでユニットテストを記述する
